/*!-----------------------------------------------------
 * xZoom v1.0.1
 * (c) 2013 by Azat Ahmedov & Elman Guseynov
 * https://github.com/payalord
 * https://dribbble.com/elmanvebs
 * Apache License 2.0
 *------------------------------------------------------*/
;window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,20)}})();function detect_old_ie(){if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var a=new Number(RegExp.$1);if(a>=9){return false}else{if(a>=8){return true}else{if(a>=7){return true}else{if(a>=6){return true}else{if(a>=5){return true}}}}}}else{return false}}(function(b){function a(aw,aF){this.xzoom=true;var F=this;var N;var aC={};var ac,aj,Z,ai,ab,ah,al,S,aE,y,an;var ax,o,Q,U,T,aa,p=new Array();var G=new Array(),aB=0,z=0;var J,R,l,k;var ap,aA,av,at,P,n,aK,aI,az,ay,X,V,ao,ak=0;var h,ag;var aJ,C=0,A=0,af=0,ad=0,s=0,r=0,ar=0,aq=0,I=0,H=0;var E=detect_old_ie(),B=/MSIE (\d+\.\d+);/.test(navigator.userAgent),Y,W;var L,j="",K,w;var aH,f,m,q,g,i,am,d,t;this.adaptive=function(){if(m==0||q==0){aw.css("width","");aw.css("height","");m=aw.width();q=aw.height()}aG();aH=b(window).width();f=b(window).height();g=aw.width();i=aw.height();var u=false;if(m>aH||q>f){u=true}if(g>m){g=m}if(i>q){i=q}if(u){aw.width("100%")}else{if(m!=0){aw.width(m)}}if(am!="fullscreen"){if(aD()){F.options.position=am}else{F.options.position=F.options.mposition}}if(!F.options.lensReverse){d=F.options.adaptiveReverse&&F.options.position==F.options.mposition}};function au(){var aL=document.documentElement;var v=(window.pageXOffset||aL.scrollLeft)-(aL.clientLeft||0);var u=(window.pageYOffset||aL.scrollTop)-(aL.clientTop||0);return{left:v,top:u}}function aD(){var u=aw.offset();if(F.options.zoomWidth=="auto"){Z=g}else{Z=g/m*F.options.zoomWidth}if(F.options.zoomHeight=="auto"){ai=i}else{ai=g/q*F.options.zoomHeight}if(F.options.position.substr(0,1)=="#"){aC=b(F.options.position)}else{aC.length=0}if(aC.length!=0){return true}switch(am){case"lens":case"inside":return true;break;case"top":ah=u.top;al=u.left;S=ah-i;aE=al;break;case"left":ah=u.top;al=u.left;S=ah;aE=al-g;break;case"bottom":ah=u.top;al=u.left;S=ah+i;aE=al;break;case"right":default:ah=u.top;al=u.left;S=ah;aE=al+g}if(aE+Z>aH||aE<0){return false}return true}this.xscroll=function(v){v.preventDefault();if(v.xscale){var u=v.pageX||v.originalEvent.pageX;var aM=v.pageY||v.originalEvent.pageY;ak=v.xscale;M(u,aM)}else{var aL=-v.originalEvent.detail||v.originalEvent.wheelDelta||v.xdelta;var u=v.pageX||v.originalEvent.pageX;var aM=v.pageY||v.originalEvent.pageY;if(E){u=Y;aM=W}if(aL>0){aL=-0.05}else{aL=0.05}ak+=aL;M(u,aM)}};function x(){if(F.options.lensShape=="circle"&&F.options.position=="lens"){ap=aA=Math.max(ap,aA);var u=(ap+Math.max(n,P)*2)/2;l.css({"-moz-border-radius":u,"-webkit-border-radius":u,"border-radius":u})}}function D(u,aM,aL,v){if(F.options.position=="lens"){R.css({top:-(aM-ah)*ay+(aA/2),left:-(u-al)*az+(ap/2)});if(F.options.bg){l.css({"background-image":"url("+R.attr("src")+")","background-repeat":"no-repeat","background-position":(-(u-al)*az+(ap/2))+"px "+(-(aM-ah)*ay+(aA/2))+"px"});if(aL&&v){l.css({"background-size":aL+"px "+v+"px"})}}}else{R.css({top:-at*ay,left:-av*az})}}function M(u,aN){if(ak<-1){ak=-1}if(ak>1){ak=1}if(X<V){var aM=X-(X-1)*ak;var v=Z*aM;var aL=v/ao}else{var aM=V-(V-1)*ak;var aL=ai*aM;var v=aL*ao}if(t&&aJ){C=u;A=aN;af=v;ad=aL}else{if(!aJ){s=af=v;r=ad=aL}az=v/ac;ay=aL/aj;ap=Z/az;aA=ai/ay;x();e(u,aN);R.width(v);R.height(aL);l.width(ap);l.height(aA);l.css({top:at-n,left:av-P});k.css({top:-at,left:-av});D(u,aN,v,aL)}}function c(){var u=ar;var aO=aq;var v=I;var aL=H;var aN=s;var aM=r;u+=(C-u)/F.options.smoothLensMove;aO+=(A-aO)/F.options.smoothLensMove;v+=(C-v)/F.options.smoothZoomMove;aL+=(A-aL)/F.options.smoothZoomMove;aN+=(af-aN)/F.options.smoothScale;aM+=(ad-aM)/F.options.smoothScale;az=aN/ac;ay=aM/aj;ap=Z/az;aA=ai/ay;x();e(u,aO);R.width(aN);R.height(aM);l.width(ap);l.height(aA);l.css({top:at-n,left:av-P});k.css({top:-at,left:-av});e(v,aL);D(u,aO,aN,aM);ar=u;aq=aO;I=v;H=aL;s=aN;r=aM;if(aJ){requestAnimFrame(c)}}function e(u,v){u-=al;v-=ah;av=u-(ap/2);at=v-(aA/2);if(F.options.position!="lens"){if(av<0){av=0}if(av>ac-ap){av=ac-ap}if(at<0){at=0}if(at>aj-aA){at=aj-aA}}}function aG(){if(typeof ax!="undefined"){ax.remove()}if(typeof Q!="undefined"){Q.remove()}if(typeof w!="undefined"){w.remove()}}function O(u,aL){if(F.options.position=="fullscreen"){ac=b(window).width();aj=b(window).height()}else{ac=aw.width();aj=aw.height()}U.css({top:aj/2-U.height()/2,left:ac/2-U.width()/2});if(F.options.rootOutput||F.options.position=="fullscreen"){ab=aw.offset()}else{ab=aw.position()}ab.top=Math.round(ab.top);ab.left=Math.round(ab.left);switch(F.options.position){case"fullscreen":ah=au().top;al=au().left;S=0;aE=0;break;case"inside":ah=ab.top;al=ab.left;S=0;aE=0;break;case"top":ah=ab.top;al=ab.left;S=ah-aj;aE=al;break;case"left":ah=ab.top;al=ab.left;S=ah;aE=al-ac;break;case"bottom":ah=ab.top;al=ab.left;S=ah+aj;aE=al;break;case"right":default:ah=ab.top;al=ab.left;S=ah;aE=al+ac}ah-=ax.outerHeight()/2;al-=ax.outerWidth()/2;if(F.options.position.substr(0,1)=="#"){aC=b(F.options.position)}else{aC.length=0}if(aC.length==0&&F.options.position!="inside"&&F.options.position!="fullscreen"){if(!F.options.adaptive||!m||!q){m=ac;q=aj}if(F.options.zoomWidth=="auto"){Z=ac}else{Z=ac/m*F.options.zoomWidth}if(F.options.zoomHeight=="auto"){ai=aj}else{ai=ac/q*F.options.zoomHeight}S+=F.options.Yoffset;aE+=F.options.Xoffset;Q.css({width:Z+"px",height:ai+"px",top:S,left:aE});if(F.options.position!="lens"){N.append(Q)}}else{if(F.options.position=="inside"||F.options.position=="fullscreen"){Z=ac;ai=aj;Q.css({width:Z+"px",height:ai+"px"});ax.append(Q)}else{Z=aC.width();ai=aC.height();if(F.options.rootOutput){S=aC.offset().top;aE=aC.offset().left;N.append(Q)}else{S=aC.position().top;aE=aC.position().left;aC.parent().append(Q)}S+=(aC.outerHeight()-ai-Q.outerHeight())/2;aE+=(aC.outerWidth()-Z-Q.outerWidth())/2;Q.css({width:Z+"px",height:ai+"px",top:S,left:aE})}}if(F.options.title&&j!=""){if(F.options.position=="inside"||F.options.position=="lens"||F.options.position=="fullscreen"){y=S;an=aE;ax.append(w)}else{y=S+(Q.outerHeight()-ai)/2;an=aE+(Q.outerWidth()-Z)/2;N.append(w)}w.css({width:Z+"px",height:ai+"px",top:y,left:an})}ax.css({width:ac+"px",height:aj+"px",top:ah,left:al});o.css({width:ac+"px",height:aj+"px"});if(F.options.tint&&(F.options.position!="inside"&&F.options.position!="fullscreen")){o.css("background-color",F.options.tint)}else{if(E){o.css({"background-image":"url("+aw.attr("src")+")","background-color":"#fff"})}}ar=C=u;aq=A=aL;J=new Image();var v="";if(B){v="?r="+(new Date()).getTime()}J.src=aw.attr("xoriginal")+v;R=b(J);R.css("position","absolute");J=new Image();J.src=aw.attr("src");k=b(J);k.css("position","absolute");k.width(ac);switch(F.options.position){case"fullscreen":case"inside":Q.append(R);break;case"lens":l.append(R);if(F.options.bg){R.css({display:"none"})}break;default:Q.append(R);l.append(k)}}this.openzoom=function(u){if(F.options.adaptive){F.adaptive()}ak=F.options.defaultScale;aJ=false;ax=b("<div></div>");if(F.options.sourceClass!=""){ax.addClass(F.options.sourceClass)}ax.css("position","absolute");U=b("<div></div>");if(F.options.loadingClass!=""){U.addClass(F.options.loadingClass)}U.css("position","absolute");o=b('<div style="position: absolute; top: 0; left: 0;"></div>');ax.append(U);Q=b("<div></div>");if(F.options.zoomClass!=""&&F.options.position!="fullscreen"){Q.addClass(F.options.zoomClass)}Q.css({position:"absolute",overflow:"hidden",opacity:1});if(F.options.title&&j!=""){w=b("<div></div>");K=b("<div></div>");w.css({position:"absolute",opacity:1});if(F.options.titleClass){K.addClass(F.options.titleClass)}K.html("<span>"+j+"</span>");w.append(K);if(F.options.fadeIn){w.css({opacity:0})}}l=b("<div></div>");if(F.options.lensClass!=""){l.addClass(F.options.lensClass)}l.css({position:"absolute",overflow:"hidden"});if(F.options.lens){lenstint=b("<div></div>");lenstint.css({position:"absolute",background:F.options.lens,opacity:F.options.lensOpacity,width:"100%",height:"100%",top:0,left:0,"z-index":9999});l.append(lenstint)}if(F.options.position!="inside"&&F.options.position!="fullscreen"){if(F.options.tint||E){ax.append(o)}if(F.options.fadeIn){o.css({opacity:0});l.css({opacity:0});Q.css({opacity:0})}N.append(ax)}else{if(F.options.fadeIn){Q.css({opacity:0})}N.append(ax)}F.eventleave(ax);O(u.pageX,u.pageY);switch(F.options.position){case"inside":S-=(Q.outerHeight()-Q.height())/2;aE-=(Q.outerWidth()-Q.width())/2;break;case"top":S-=Q.outerHeight()-Q.height();aE-=(Q.outerWidth()-Q.width())/2;break;case"left":S-=(Q.outerHeight()-Q.height())/2;aE-=Q.outerWidth()-Q.width();break;case"bottom":aE-=(Q.outerWidth()-Q.width())/2;break;case"right":S-=(Q.outerHeight()-Q.height())/2}Q.css({top:S,left:aE});R.bind("load",function(){U.remove();if(F.options.scroll){F.eventscroll(ax)}if(F.options.position!="inside"&&F.options.position!="fullscreen"){ax.append(l);if(F.options.fadeIn){o.fadeTo(300,F.options.tintOpacity);l.fadeTo(300,1);Q.fadeTo(300,1)}else{o.css({opacity:F.options.tintOpacity});l.css({opacity:1});Q.css({opacity:1})}}else{if(F.options.fadeIn){Q.fadeTo(300,1)}else{Q.css({opacity:1})}}if(F.options.title&&j!=""){if(F.options.fadeIn){w.fadeTo(300,1)}else{w.css({opacity:1})}}h=R.width();ag=R.height();if(F.options.adaptive){if(ac<m||aj<q){k.width(ac);k.height(aj);h=ac/m*h;ag=aj/q*ag;R.width(h);R.height(ag)}}s=af=h;r=ad=ag;ao=h/ag;X=h/Z;V=ag/ai;n=(parseFloat(l.css("padding-top"))+parseFloat(l.css("padding-bottom"))+parseFloat(l.css("border-top"))+parseFloat(l.css("border-bottom")))/2;P=(parseFloat(l.css("padding-left"))+parseFloat(l.css("padding-right"))+parseFloat(l.css("border-left"))+parseFloat(l.css("border-right")))/2;M(u.pageX,u.pageY);if(t&&!F.options.bg){aJ=true;requestAnimFrame(c)}F.eventmove(ax);F.eventclick(ax)})};this.movezoom=function(v){if(E){Y=v.pageX;W=v.pageY}var u=v.pageX-al;var aL=v.pageY-ah;if(d){v.pageX-=(u-ac/2)*2;v.pageY-=(aL-aj/2)*2}if(u<0||u>ac||aL<0||aL>aj){ax.trigger("mouseleave")}if(t&&!F.options.bg){C=v.pageX;A=v.pageY}else{x();e(v.pageX,v.pageY);l.css({top:at-n,left:av-P});k.css({top:-at,left:-av});D(v.pageX,v.pageY,0,0)}};this.eventdefault=function(){F.eventopen=function(u){u.bind("mouseenter",F.openzoom)};F.eventleave=function(u){u.bind("mouseleave",F.closezoom)};F.eventmove=function(u){u.bind("mousemove",F.movezoom)};F.eventscroll=function(u){u.bind("mousewheel DOMMouseScroll",F.xscroll)};F.eventclick=function(u){u.bind("click",function(v){aw.trigger("click")})}};this.eventunbind=function(){aw.unbind("mouseenter");F.eventopen=function(u){};F.eventleave=function(u){};F.eventmove=function(u){};F.eventscroll=function(u){};F.eventclick=function(u){}};this.init=function(u){F.options=b.extend({},b.fn.xzoom.defaults,u);if(F.options.rootOutput){N=b("body")}else{N=aw.parent()}am=F.options.position;d=F.options.lensReverse&&F.options.position=="inside";if(F.options.smoothZoomMove<0){F.options.smoothZoomMove=0}if(F.options.smoothLensMove<0){F.options.smoothLensMove=0}if(F.options.smoothScale<0){F.options.smoothScale=0}t=F.options.smoothZoomMove&&F.options.smoothLensMove&&F.options.smoothScale;if(F.options.adaptive){b(window).load(function(){m=aw.width();q=aw.height();F.adaptive();b(window).resize(F.adaptive)})}F.eventdefault();F.eventopen(aw)};this.destroy=function(){F.eventunbind();delete F};this.closezoom=function(){aJ=false;if(F.options.fadeOut){if(F.options.title&&j!=""){w.fadeOut(299)}if(F.options.position!="inside"||F.options.position!="fullscreen"){Q.fadeOut(299);ax.fadeOut(300,function(){aG()})}else{ax.fadeOut(300,function(){aG()})}}else{aG()}};this.gallery=function(){var aL=new Array();var v,u=0;for(v=z;v<G.length;v++){aL[u]=G[v];u++}for(v=0;v<z;v++){aL[u]=G[v];u++}return{index:z,ogallery:G,cgallery:aL}};function ae(u){var aL=u.attr("title");var v=u.attr("xtitle");if(v){return v}else{if(aL){return aL}else{return""}}}this.xappend=function(u){var v=u.parent();G[aB]=v.attr("href");v.data("xindex",aB);if(aB==0&&F.options.activeClass){L=u;L.addClass(F.options.activeClass)}if(aB==0&&F.options.title){j=ae(u)}aB++;function aL(aN){aG();aN.preventDefault();if(F.options.activeClass){L.removeClass(F.options.activeClass);L=u;L.addClass(F.options.activeClass)}z=b(this).data("xindex");if(F.options.fadeTrans){aa=new Image();aa.src=aw.attr("src");T=b(aa);T.css({position:"absolute",top:aw.offset().top,left:aw.offset().left,width:aw.width(),height:aw.height()});b(document.body).append(T);T.fadeOut(200,function(){T.remove()})}var aO=v.attr("href");var aM;if(u.attr("xpreview")){aM=u.attr("xpreview")}else{aM=u.attr("src")}j=ae(u);if(u.attr("title")){aw.attr("title",u.attr("title"))}aw.attr("xoriginal",aO);aw.attr("src",aM)}if(F.options.hover){v.bind("mouseenter",v,aL)}v.bind("click",v,aL)};this.init(aF)}b.fn.xzoom=function(e){var c;var d;if(this.selector){var g=this.selector.split(",");for(var f in g){g[f]=b.trim(g[f])}this.each(function(h){if(g.length==1){if(h==0){c=b(this);if(typeof(c.data("xzoom"))!=="undefined"){return c.data("xzoom")}c.x=new a(c,e)}else{if(typeof(c.x)!=="undefined"){d=b(this);c.x.xappend(d)}}}else{if(b(this).is(g[0])&&h==0){c=b(this);if(typeof(c.data("xzoom"))!=="undefined"){return c.data("xzoom")}c.x=new a(c,e)}else{if(typeof(c.x)!=="undefined"&&!b(this).is(g[0])){d=b(this);c.x.xappend(d)}}}})}else{this.each(function(h){if(h==0){c=b(this);if(typeof(c.data("xzoom"))!=="undefined"){return c.data("xzoom")}c.x=new a(c,e)}else{if(typeof(c.x)!=="undefined"){d=b(this);c.x.xappend(d)}}})}if(typeof(c)==="undefined"){return false}c.data("xzoom",c.x);b(c).trigger("xzoom_ready");return c.x};b.fn.xzoom.defaults={position:"right",mposition:"inside",rootOutput:true,Xoffset:0,Yoffset:0,fadeIn:true,fadeTrans:true,fadeOut:false,smoothZoomMove:3,smoothLensMove:1,smoothScale:6,defaultScale:0,scroll:true,tint:false,tintOpacity:0.5,lens:false,lensOpacity:0.5,lensShape:"box",zoomWidth:"auto",zoomHeight:"auto",sourceClass:"xzoom-source",loadingClass:"xzoom-loading",lensClass:"xzoom-lens",zoomClass:"xzoom-preview",activeClass:"xactive",hover:false,adaptive:true,lensReverse:false,adaptiveReverse:false,title:false,titleClass:"xzoom-caption",bg:false}})(jQuery);